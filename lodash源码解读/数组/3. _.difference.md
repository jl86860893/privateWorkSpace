```js
_.difference([3, 2, 1], [4, 2]);
// => [3, 1]
```
创建一个具有唯一array值的数组，每个值不包含在其他给定的数组中。（注：即创建一个新数组，这个数组中的值，为第一个数字（array 参数）排除了给定数组中的值。）该方法使用`SameValueZero`做相等比较。结果值的顺序是由第一个数组中的顺序确定。

### 辅助判断方法
```js
/**
isArrayLike
*/
const MAX_SAFE_INTEGER = 9007199254740991

function isLength(value) {
  return typeof value === 'number' &&
    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER
}

function isArrayLike(value) {
  return value != null && typeof value !== 'function' && isLength(value.length)
}

/**
isObjectLike
*/
function isObjectLike(value) {
  return typeof value === 'object' && value !== null
}

/**
isArrayLikeObject
*/
function isArrayLikeObject(value) {
  return isObjectLike(value) && isArrayLike(value)
}
```

## baseDifference
**使用对象缓存的方式模拟数组的增删改查，对 `length` 大于200的数组进行优化**
```js
import SetCache from './SetCache.js'
import arrayIncludes from './arrayIncludes.js'  // indexOf判断
import arrayIncludesWith from './arrayIncludesWith.js'  // arrayIncludesWith(array, target, comparator)  通过comparator对比
import map from '../map.js'
/**
 function map(array, iteratee) {
  let index = -1
  const length = array == null ? 0 : array.length
  const result = new Array(length)

  while (++index < length) {
    result[index] = iteratee(array[index], index, array)
  }
  return result
}
*/
import cacheHas from './cacheHas.js'
/**
  function cacheHas(cache, key) {
    return cache.has(key)
  }
*/

const LARGE_ARRAY_SIZE = 200

function baseDifference(array, values, iteratee, comparator) {
  let includes = arrayIncludes
  let isCommon = true
  const result = []
  const valuesLength = values.length

  if (!array.length) {
    return result
  }
  if (iteratee) {
    values = map(values, (value) => iteratee(value))
  }
  if (comparator) {
    includes = arrayIncludesWith
    isCommon = false
  }
  else if (values.length >= LARGE_ARRAY_SIZE) {
    includes = cacheHas
    isCommon = false
    values = new SetCache(values)
  }
  outer:
  for (let value of array) {
    const computed = iteratee == null ? value : iteratee(value)

    value = (comparator || value !== 0) ? value : 0
    if (isCommon && computed === computed) {
      let valuesIndex = valuesLength
      while (valuesIndex--) {
        if (values[valuesIndex] === computed) {
          continue outer
        }
      }
      result.push(value)
    }
    else if (!includes(values, computed, comparator)) {
      result.push(value)
    }
  }
  return result
}

export default baseDifference
```

## difference
```js
import baseDifference from './.internal/baseDifference.js'
import baseFlatten from './.internal/baseFlatten.js'
import isArrayLikeObject from './isArrayLikeObject.js'

function difference(array, ...values) {
  return isArrayLikeObject(array)
    ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))
    : []
}

export default difference
```
